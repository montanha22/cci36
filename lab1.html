<html>
<head>
<meta charset=utf-8>
<title>Rotation Sequence</title>
<!-- Another THREE.JS Example by Prof. Carlos Forster from
 Technological Institute of Aeronautics 27/8/2021 --> 
<style>
  body {margin:0; overflow:hidden;}
</style>
</head>

<body>
<!-- canvas id="hicanvas" width="600" height="600"></canvas -->
<canvas id="offscreen" width="600" height="600" style="display:none"></canvas>

<p>Exemplo de um canvas transparente ajustado para o tamanho de uma imagem</p>

<img id="ico" width="500" height="400" src="static/avenida-paulista-24h.jpg" />


<script type="module">
  import * as THREE from 'https://cdn.skypack.dev/three@0.132.2';
  import { OrbitControls } from 'https://cdn.skypack.dev/three@0.132.2/examples/jsm/controls/OrbitControls.js';

  var k = document.getElementById("ico");
  var b = k.getBoundingClientRect(); 
  console.log(b);

  var x = document.createElement("CANVAS");
  
  x.style.position="absolute";
  x.width=b.width;
  x.height=b.height;
  x.style.top=""+b.top+"px";
  x.style.left=""+b.left+"px";

  document.body.appendChild(x);

  var canvas= x 

  const scene = new THREE.Scene()
  const camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 1000)
  const renderer = new THREE.WebGLRenderer({antialias:true, canvas: canvas, alpha:true})

  camera.position.set(300,300,-300)
  camera.lookAt(0,0,0)

  // adding camera control
  var controls = new OrbitControls( camera, renderer.domElement )

  // adding axes lines to scene
  var axesHelper = new THREE.AxesHelper( 5 )
  scene.add(axesHelper)

  scene.add(camera)

  window.onresize=canvasResize

  function canvasResize()
  {
    camera.aspect=window.innerWidth / window.innerHeight
    camera.updateProjectionMatrix();
  }

  function createCarBase(){
      const geometry = new THREE.BoxGeometry(4.5, 0.8, 1.8);
      const material = new THREE.MeshBasicMaterial( { color: 0x0000ff } );
      const carBase = new THREE.Mesh( geometry, material );
      return carBase;
  }
  function createCarTop(){
      const geometry = new THREE.BoxGeometry(3, 0.8, 1.8);
      const material = new THREE.MeshBasicMaterial( { color: 0x0000ff } );
      const carTop = new THREE.Mesh( geometry, material );
      carTop.position.y += 0.8;
      carTop.position.x -= 0.75;
      return carTop;
  }
  function createWheels(){
      const geometry = new THREE.CylinderGeometry(0.4, 0.4, 0.19);
      const material = new THREE.MeshBasicMaterial( { color: 0xffffff } );
      const wheel = new THREE.Mesh( geometry, material );
      wheel.position.y = -0.4;
      wheel.rotation.x += Math.PI / 2;
      var dz = 0.9 - 0.19/2 + 0.01;
      var dx = 1.2;
      var wheels = new THREE.Group()
      var positions = [[dx,dz], [dx, -dz], [-dx, dz], [-dx, -dz]]
      for (var i = 0; i<positions.length; i++){
          var w = wheel.clone()
          w.position.x = positions[i][0]
          w.position.z = positions[i][1]
          wheels.add(w)
      }
      return wheels
  }

  const carBase = createCarBase();
  const carTop = createCarTop();
  const wheels = createWheels();
  const car = new THREE.Group()
  car.add( carBase ); car.add( carTop ); car.add( wheels )
  
  car.position.x = 10
  scene.add( car );


  function animate()
  {
    requestAnimationFrame(animate);
    console.log(camera)
    renderer.render(scene,camera)
  }

  animate()

</script>

</body>
</html>